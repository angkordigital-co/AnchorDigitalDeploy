# Milestone v1.0: MVP

**Status:** SHIPPED 2026-02-02
**Phases:** 1-3
**Total Plans:** 11

## Overview

Build a self-hosted serverless deployment platform for Next.js applications on AWS. Start with core infrastructure and automated build pipeline, add deployment and custom domain capabilities, then finish with a management dashboard for multi-site operations. Each phase delivers a complete, verifiable capability that brings us closer to production-ready automated deployments.

## Phases

### Phase 1: Infrastructure & Build

**Goal**: Automated build pipeline transforms GitHub pushes into deployable Next.js artifacts

**Depends on**: Nothing (first phase)

**Plans**: 4 plans

Plans:
- [x] 01-01: SST Infrastructure Foundation (DynamoDB + S3 with lifecycle policies)
- [x] 01-02: GitHub Webhook Integration (API Gateway + signature validation)
- [x] 01-03: Build Pipeline (CodeBuild + SQS orchestration with OpenNext)
- [x] 01-04: Environment Variables & Build Logs (configuration + CloudWatch)

**Details:**

**Requirements covered:** INFRA-01, INFRA-02, INFRA-03, INFRA-04, GIT-01, GIT-02, GIT-03, GIT-04, BUILD-01, BUILD-02, BUILD-03, BUILD-04, BUILD-05

**Success Criteria achieved:**
1. GitHub push to main triggers build automatically via webhook
2. Build runs `npm install` and `next build` with OpenNext packaging
3. User can view real-time build logs during deployment
4. Build artifacts stored in S3 with metadata in DynamoDB
5. Environment variables can be configured and used during builds

**Key Deliverables:**
- SST Ion v3 infrastructure (sst.config.ts, infra/*)
- DynamoDB tables (projects, deployments)
- S3 buckets (artifacts with 90-day lifecycle, logs with Glacier)
- GitHub webhook handler with HMAC-SHA256 validation
- SQS-triggered CodeBuild pipeline with OpenNext packaging
- Environment variables API with build-time injection
- Build logs API via CloudWatch

### Phase 2: Deployment & CDN

**Goal**: Next.js sites deploy to Lambda with custom domains and automatic SSL

**Depends on**: Phase 1

**Plans**: 3 plans

Plans:
- [x] 02-01: CloudFront + Lambda Deployment Infrastructure
- [x] 02-02: Deploy Orchestrator + Build Integration
- [x] 02-03: Rollback API + Custom Domains with ACM

**Details:**

**Requirements covered:** INFRA-05, DEPLOY-01, DEPLOY-02, DEPLOY-03, DEPLOY-04, DEPLOY-05, DEPLOY-06, DOMAIN-01, DOMAIN-02, DOMAIN-03, DOMAIN-04

**Success Criteria achieved:**
1. Next.js SSR pages render via Lambda functions
2. Next.js API routes work correctly via Lambda
3. Static assets serve from CloudFront with CDN caching
4. Custom domains configured with automatic SSL via ACM
5. User can rollback to previous deployment instantly
6. Deployments complete with zero downtime

**Key Deliverables:**
- CloudFront distribution with S3 and Lambda origins
- Lambda functions with aliases for zero-downtime deployment
- Deploy handler with version publishing and alias updates
- Rollback handler with instant alias switching
- Custom domains handler with ACM certificate automation
- DomainsTable for domain metadata storage

### Phase 3: Dashboard & Observability

**Goal**: Web dashboard provides full visibility and control over all deployed sites

**Depends on**: Phase 2

**Plans**: 4 plans

Plans:
- [x] 03-01: Dashboard Foundation + Auth (Next.js 16, Auth.js v5, shadcn/ui layout)
- [x] 03-02: Sites List + Deployment History (TanStack Table, rollback UI)
- [x] 03-03: Environment Variables + Custom Domains (Server Actions for mutations)
- [x] 03-04: Observability (Logs, Metrics, Costs with CloudWatch + Cost Explorer)

**Details:**

**Requirements covered:** OBS-01, OBS-02, OBS-03, OBS-04, OBS-05, DASH-01, DASH-02, DASH-03, DASH-04, DASH-05, DASH-06, DASH-07

**Success Criteria achieved:**
1. User can log in to web dashboard and view all connected sites
2. User can view deployment history and trigger rollbacks
3. User can view and edit environment variables from dashboard
4. User can configure custom domains from dashboard
5. User can view runtime logs, errors, and performance metrics
6. User can view AWS cost breakdown per site

**Key Deliverables:**
- Next.js 16 dashboard application with shadcn/ui component library
- Auth.js v5 with DynamoDB credentials provider
- Sites list, deployment history, rollback UI
- Environment variables management
- Custom domains management with DNS validation display
- Runtime logs viewer with CloudWatch Logs
- Performance metrics charts with CloudWatch
- Cost breakdown with Cost Explorer

---

## Milestone Summary

**Key Decisions:**
- Serverless over Docker: Cost efficiency at scale, pay only for usage
- Lambda aliases for zero-downtime: Instant rollback via alias switch (<1s)
- SST Ion v3 for infrastructure: Modern IaC with live dev mode
- OpenNext for Lambda packaging: Standard Next.js â†’ Lambda adapter
- Auth.js v5 for dashboard: JWT sessions, serverless-friendly
- ACM certificates in us-east-1: CloudFront requirement for custom domains

**Issues Resolved:**
- Multi-tenant data isolation: Row-level security with userId GSI
- Lambda packaging for Next.js: OpenNext adapter handles App Router, SSR, API routes
- Zero-downtime deployments: Lambda aliases with atomic switching

**Issues Deferred:**
- API_GATEWAY_URL env var configuration (simple environment setup)
- CloudFront cache invalidation (relies on TTL for now)
- Secrets Manager migration for secret env vars

**Technical Debt Incurred:**
- Secret env vars stored in DynamoDB instead of Secrets Manager
- No automated CloudFront invalidation on deploy
- Dashboard needs API_GATEWAY_URL environment variable configured

---

_For current project status, see .planning/ROADMAP.md_
